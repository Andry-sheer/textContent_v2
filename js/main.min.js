
let pay = 0;
let pay_2 = 0;
const container = document.querySelector('.onlineStore__container');
const containerOrders = document.querySelector('.orders__container');
const contImg = document.querySelector('.onlineStore__img-sliderContainer');
const img1 = document.querySelector('.onlineStore__img1');
const img2 = document.querySelector('.onlineStore__img2');
const dottedOne = document.querySelector('.onlineStore__dotted-1');
const dottedTwo = document.querySelector('.onlineStore__dotted-2');
const price = document.querySelector('.onlineStore__price');

const formTitle = document.querySelector('.onlineStore__form-titlePayment');
const buy = document.querySelector('.onlineStore__buy');
const guds = document.querySelector('.onlineStore__guds');
guds.textContent = 0;
const removeGuds = document.querySelector('.onlineStore__remGuds');
const addGuds = document.querySelector('.onlineStore__addGuds');
const submitButton = document.querySelector('.onlineStore__submitButton');

const errorMessage = document.querySelector('.onlineStore__errorContainer');
const errorDiscription = document.querySelector('.onlineStore__errorDiscription');

const payMethod = document.querySelector('.orders__desk-price');
const cash = document.querySelector('#cashID');
const card = document.querySelector('#cardID');

const orderItem = document.querySelector('.orders__par-label');
orderItem.textContent = '(Items)';

const orderNum = document.querySelector('.orders__number');
orderNum.textContent = 0

const orderPrice = document.querySelector('.orders__price');
orderPrice.textContent = '$0'

const form = document.querySelector('.onlineStore__form');

let orderContainer = document.querySelector('.orders__orderContainer');


//?========= PAY METHOD ===========================================
cash.addEventListener('click', selectCash);
function selectCash(){
  payMethod.textContent = 'Cash on delivery';
  payMethod.style.color = '#2b8d78';
}

card.addEventListener('click', selectCard);
function selectCard(){
  payMethod.textContent = 'Card payment'
  payMethod.style.color = '#2b8d78';
}

//?========= SHOW FORMS on click Button ===========================================
buy.addEventListener('click', showForm);
function showForm(){
  form.style.display = 'flex';
  formTitle.style.display = 'flex';
  buy.style.display = 'none';
  submitButton.style.justifyContent = 'center';
  submitButton.textContent = 'Pay $' + pay;
}

//?====== REMOVE GUDS BUTTON =======================================
removeGuds.addEventListener('click', gudsMinus);
function gudsMinus(e){
  e.preventDefault();
  guds.textContent--;
  orderNum.textContent--;
  submitButton.textContent = `Pay $${pay -= 9.99}`;
  orderPrice.textContent = `$${pay_2 -= 9.99}`;
  if (guds.textContent <= 0) {
    submitButton.textContent = `Pay $${pay = 0}`;
    orderPrice.textContent = `$${pay_2 = 0}`;
    removeGuds.disabled = true;
  }

}

//?====== ADD GUDS BUTTON =======================================
addGuds.addEventListener('click', gudsAdd);
function gudsAdd(e){
  e.preventDefault();
  guds.textContent++;
  orderNum.textContent++;
  submitButton.textContent = `Pay $${pay += 9.99}`; 
  orderPrice.textContent = `$${pay_2 += 9.99}`;

  if (guds.textContent >= 1) {
  removeGuds.disabled = false;
  }
  
}

//?===== ADD SLIDER + DOTTED SLIDER ==============================
img1.addEventListener('click', nextSlide);
function nextSlide () {
  setTimeout(() => {
    img1.style.display = 'none',
    img2.style.display = 'block'
  }, 100)
  
  dottedOne.style.background = 'transparent';
  dottedTwo.style.background = '#588077';
}

// setTimeout(() => {
//     img1.style.display = 'none',
//     img2.style.display = 'block',
//     dottedOne.style.background = 'transparent',
//     dottedTwo.style.background = '#588077'
//   }, 1000)

setTimeout (nextSlide, 1000);
  
  

img2.addEventListener('click', prevSlide);
function prevSlide () {
  setTimeout(()=> {
    img1.style.display = 'block';
    img2.style.display = 'none';
  }, 100);
  
  dottedOne.style.background = '#588077';
  dottedTwo.style.background = 'transparent';
}

  // setTimeout(()=> {
  //   img1.style.display = 'block',
  //   img2.style.display = 'none',
  //   dottedOne.style.background = '#588077',
  //   dottedTwo.style.background = 'transparent'
  // }, 1000);
  
  setTimeout (prevSlide, 2000);





//?======= VALIDATION NAME =======================================
const firstName = document.querySelector('input[name = "name"]');
const patternName = /^[A-Z][a-z]{3,}$/;

firstName.addEventListener('input', (event) => {
  const nameIN = event.target.value;
  const nameINvalid = patternName.test(nameIN);

if (nameINvalid){
  errorMessage.style.display = 'flex';
  errorMessage.style.background = 'green';
  errorDiscription.textContent = 'name IS valid!';

} else {
    errorMessage.style.display = 'flex';
    errorMessage.style.background = '#AB4B4B';
    errorDiscription.textContent = 'name is Invalid! field must be One big latter, small letter, 3 symbols';
  }

  if (form.addEventListener('focusin', ()=> { errorMessage.style.display = 'none'; }));
  });





//?======== VALID PHONE =========================================
const mobilePhone = document.querySelector('input[name = "phone"]');
const patternPhone = /^(\+)?[\d()-]{10,13}$/;

mobilePhone.addEventListener('input', (event) => {
  const phoneIN = event.target.value;
  const phoneINvalid = patternPhone.test(phoneIN);

if (phoneINvalid){
  errorMessage.style.display = 'flex';
  errorMessage.style.background = 'green';
  errorDiscription.textContent = 'your phone is valid!';

} else {
    errorMessage.style.display = 'flex';
    errorMessage.style.background = '#AB4B4B';
    errorDiscription.textContent = 'phone is invalid phome must be " +, ( ), - " min 10 symbols';
  }

  if (form.addEventListener('focusin', ()=> { errorMessage.style.display = 'none'; }));
  });




//? ========= VALID EMAIL =========================================
const email = document.querySelector('input[name = "email"]');
const patternEmail = /^[a-zA-z0-9_.-]{5,}@[a-zA-Z0-9]+\.[a-zA-Z]{2,}$/;

email.addEventListener('input', (event) => {
  const emailIN = event.target.value;
  const emailINvalid = patternEmail.test(emailIN);

if (emailINvalid){
  errorMessage.style.display = 'flex';
  errorMessage.style.background = 'green';
  errorDiscription.textContent = 'your mail@ is valid!';

} else {
    errorMessage.style.display = 'flex';
    errorMessage.style.background = '#AB4B4B';
    errorDiscription.textContent = 'email is invalid! email must be " @ . " min 5 symbols';
  }

  if (form.addEventListener('focusin', ()=> { errorMessage.style.display = 'none'; }));
  });





// //?===== FORM OF ORDER =================================================
document.querySelector('#formID').addEventListener('submit', function(e){
  e.preventDefault();

  const formData = new FormData(this);
  const formObject = {};

formData.forEach(function(value, key) {
  if(!formObject[key]) {
    formObject[key] = value
  } else {
    formObject[key] = `${formObject[key]}, ${value}`
  }
});

  document.querySelector('.p1').textContent =  `name: ${formObject.name}`;
  document.querySelector('.p2').textContent =  `last name: ${formObject.last_name}`;
  document.querySelector('.p3').textContent =  `patronymic: ${formObject.patronymic}`;
  document.querySelector('.p4').textContent =  `e-mail: ${formObject.email}`;
  document.querySelector('.p5').textContent =  `phone: ${formObject.phone}`;
  document.querySelector('.p6').textContent =  `city: ${formObject.city}`;
  document.querySelector('.p7').textContent =  `payment: ${formObject.pay_method}`;
  document.querySelector('.p8').textContent =  `NovaPost office: â„–${formObject.NovaPost_office}`;
  document.querySelector('.p9').textContent = `guds quantity: ${guds.textContent} items`;
  document.querySelector('.p10').textContent =  `comment: ${formObject.note || `"no comments..."`}`;

    if(formObject.name === "" || formObject.last_name === "" || formObject.patronymic === "" || !formObject.city || formObject.phone.length < 10 || !formObject.pay_method || formObject.NovaPost_office.length < 0 || formObject.NovaPost_office === "" || guds.textContent <= 0){
    errorMessage.style.display = 'flex';
    errorMessage.style.background = '#AB4B4B';
    errorDiscription.textContent = 'All required fields must be correct to complete the order';
    container.style.display = 'block';
    containerOrders.style.display ='none';
  } else {
      container.style.display = 'none';
      containerOrders.style.display ='block';
    }

    form.addEventListener('focusin', () => {
      errorMessage.style.display = 'none';
    });


})




